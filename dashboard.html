<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>لوحة التحكم - اختبار تفاعلي</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(to right, #f5f7fa, #c3cfe2);
      padding: 30px;
      margin: 0;
    }

    h2 {
      text-align: center;
      color: #333;
      font-size: 32px;
      margin-bottom: 40px;
    }

    .card {
      background: #ffffff;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      margin: 20px auto;
      max-width: 800px;
      transition: transform 0.3s;
    }

    .card:hover {
      transform: translateY(-4px);
    }

    .card input, .card select, .card textarea {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border-radius: 10px;
      border: 1px solid #ddd;
      font-size: 16px;
    }

    .card button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .card button:hover {
      background-color: #45a049;
    }

    .subject, .lecture {
      margin-top: 20px;
      cursor: pointer;
      padding: 10px;
      border-radius: 8px;
      background-color: #f1f1f1;
      margin-bottom: 10px;
    }

    .subject:hover, .lecture:hover {
      background-color: #e0e0e0;
    }

    .options {
      list-style: none;
      padding: 0;
    }

    .options li {
      background: #f1f1f1;
      padding: 12px 18px;
      border-radius: 10px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: 0.3s;
      font-size: 18px;
    }

    .options li:hover {
      background: #e0e0e0;
    }

    .options li.correct {
      background-color: #a9f5bc;
      color: #065f46;
      font-weight: bold;
    }

    .options li.wrong {
      background-color: #f8d7da;
      color: #721c24;
      font-weight: bold;
    }

    .options li.disabled {
      pointer-events: none;
      opacity: 0.6;
    }

    #score-box {
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      margin-top: 40px;
      color: #2c3e50;
    }
  </style>
</head>
<body>

  <h2>لوحة التحكم - إضافة مادة / محاضرة / سؤال</h2>

  <!-- إضافة مادة -->
  <div class="card">
    <h3>إضافة مادة جديدة</h3>
    <input type="text" id="subjectName" placeholder="اسم المادة" />
    <button onclick="addSubject()">إضافة مادة</button>
  </div>

  <!-- إضافة محاضرة -->
  <div class="card">
    <h3>إضافة محاضرة جديدة</h3>
    <select id="subjectSelectForLecture">
      <option value="">اختر المادة</option>
    </select>
    <input type="text" id="lectureName" placeholder="اسم المحاضرة" />
    <button onclick="addLecture()">إضافة محاضرة</button>
  </div>

  <!-- إضافة سؤال -->
  <div class="card">
    <h3>إضافة سؤال</h3>
    <select id="subjectSelectForQuestion">
      <option value="">اختر المادة</option>
    </select>
    <select id="lectureSelectForQuestion">
      <option value="">اختر المحاضرة</option>
    </select>
    <textarea id="questionText" placeholder="نص السؤال"></textarea>
    <textarea id="optionsText" placeholder="اكتب 5 خيارات كل واحد في سطر"></textarea>
    <select id="correctOption">
      <option value="">اختر الإجابة الصحيحة</option>
      <option value="0">الخيار 1</option>
      <option value="1">الخيار 2</option>
      <option value="2">الخيار 3</option>
      <option value="3">الخيار 4</option>
      <option value="4">الخيار 5</option>
    </select>
    <button onclick="addQuestion()">إضافة سؤال</button>
  </div>

  <div id="score-box">النتيجة: 0</div>

  <div id="subjects-container"></div>

  <script>
    const firebaseConfig = {
  apiKey: "AIzaSyBfaMxkaF-QRPdf24gYCJKeLMarNNQLaBQ",
  authDomain: "storage-5ba27.firebaseapp.com",
  projectId: "storage-5ba27",
  storageBucket: "storage-5ba27.firebasestorage.app",
  messagingSenderId: "911744755254",
  appId: "1:911744755254:web:b05fea1f2d26ba9738da97",
  measurementId: "G-SVE6LCGBGE"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // إضافة مادة جديدة
    async function addSubject() {
      const subjectName = document.getElementById("subjectName").value;
      if (!subjectName) {
        alert("يرجى إدخال اسم المادة");
        return;
      }

      const subjectRef = await db.collection("subjects").add({
        name: subjectName
      });

      loadSubjects(); // إعادة تحميل المواد بعد إضافة مادة جديدة
      document.getElementById("subjectName").value = "";
    }

    // إضافة محاضرة
    async function addLecture() {
      const subjectName = document.getElementById("subjectSelectForLecture").value;
      const lectureName = document.getElementById("lectureName").value;
      if (!subjectName || !lectureName) {
        alert("يرجى اختيار المادة واسم المحاضرة");
        return;
      }

      await db.collection("subjects").doc(subjectName).collection("lectures").add({
        name: lectureName
      });

      loadLectures(); // إعادة تحميل المحاضرات بعد إضافة محاضرة جديدة
      document.getElementById("lectureName").value = "";
    }

    // إضافة سؤال
    async function addQuestion() {
      const subjectName = document.getElementById("subjectSelectForQuestion").value;
      const lectureName = document.getElementById("lectureSelectForQuestion").value;
      const questionText = document.getElementById("questionText").value;
      const optionsText = document.getElementById("optionsText").value.trim().split("\n");
      const correctOption = parseInt(document.getElementById("correctOption").value);

      if (!subjectName || !lectureName || !questionText || optionsText.length !== 5 || isNaN(correctOption)) {
        alert("يرجى إدخال جميع الحقول بشكل صحيح");
        return;
      }

      await db.collection("subjects").doc(subjectName).collection("lectures").doc(lectureName).collection("questions").add({
        question: questionText,
        options: optionsText,
        correct: correctOption
      });

      document.getElementById("questionText").value = "";
      document.getElementById("optionsText").value = "";
      document.getElementById("correctOption").value = "";
    }

    // تحميل المواد
    async function loadSubjects() {
      const subjectsContainer = document.getElementById("subjects-container");
      const snapshot = await db.collection("subjects").get();

      const subjectSelectForLecture = document.getElementById("subjectSelectForLecture");
      const subjectSelectForQuestion = document.getElementById("subjectSelectForQuestion");

      subjectSelectForLecture.innerHTML = "<option value=''>اختر المادة</option>";
      subjectSelectForQuestion.innerHTML = "<option value=''>اختر المادة</option>";

      subjectsContainer.innerHTML = "";

      snapshot.forEach(doc => {
        const subject = doc.data();
        const subjectDiv = document.createElement("div");
        subjectDiv.className = "subject";
        subjectDiv.textContent = subject.name;

        const optionForLecture = document.createElement("option");
        optionForLecture.value = subject.name;
        optionForLecture.textContent = subject.name;
        subjectSelectForLecture.appendChild(optionForLecture);

        const optionForQuestion = document.createElement("option");
        optionForQuestion.value = subject.name;
        optionForQuestion.textContent = subject.name;
        subjectSelectForQuestion.appendChild(optionForQuestion);

        subjectsContainer.appendChild(subjectDiv);
      });
    }

    loadSubjects(); // تحميل المواد عند تحميل الصفحة
  </script>
</body>
</html>
